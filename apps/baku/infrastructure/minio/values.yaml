plugin: argocd-vault-plugin-helm

ingress:
  subdomain: baku

source:
  repoURL: https://charts.min.io/
  chart: minio
  targetRevision: 5.0.3

destination:
  namespace: minio

syncPolicy:
  automated:
    prune: true
    selfHeal: true

# App values
buckets:
  - name: <path:salamandre/data/backup/s3#bucket>
    policy: none

serviceAccounts:
  - accessKey: <path:salamandre/data/backup/s3#accessKey>
    secretKey: <path:salamandre/data/backup/s3#secretKey>
    user: <path:baku/data/minio/auth#rootUser>
    policy:
      statements:
        - actions:
            - s3:GetBucketLocation
            - s3:ListBucket
            - s3:ListBucketMultipartUploads
          resources:
            - arn:aws:s3:::backup-cluster
        - actions:
            - s3:AbortMultipartUpload
            - s3:GetObject
            - s3:DeleteObject
            - s3:PutObject
            - s3:ListMultipartUploadParts
          resources:
            - arn:aws:s3:::backup-cluster/*
