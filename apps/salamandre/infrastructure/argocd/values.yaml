plugin: helm

ingress:
  subdomain: argocd

source:
  repoURL: https://argoproj.github.io/argo-helm
  chart: argo-cd
  targetRevision: 5.52.0

destination:
  namespace: argocd

syncPolicy:
  createLabeledNamespace: true # Initially created by ansible
  automated:
    prune: true
    selfHeal: true

# App values
argocdVersion: 2.9.3
gitlabProjectID: '40446088'
vaultURL: http://vault-internal.vault.svc:8200

toolsVersion:
  avp: "1.17.0"
  vault: "1.15.2"

baseOidcConfig:
  name: Zitadel
  issuer: $oidc-credentials:issuer
  clientID: $oidc-credentials:clientID
  clientSecret: $oidc-credentials:clientSecret
  logoutURL: $oidc-credentials:logoutUrl
  requestedIDTokenClaims:
    groups:
      essential: true
  requestedScopes:
    - openid
    - profile
    - email
    - groups

projects:
  - name: system
    description: System cluster critical apps
    sourceRepos:
      - "*"
    destinations:
      - namespace: "*"
        server: "*"
    clusterResourceWhitelist:
      - group: "*"
        kind: "*"
  - name: infrastructure
    description: Infrastructure apps
    sourceRepos:
      - "*"
    destinations:
      - namespace: "*"
        server: "*"
    clusterResourceWhitelist:
      - group: "*"
        kind: "*"
  - name: cloud
    description: Cloud apps
    sourceRepos:
      - "*"
    destinations:
      - namespace: "*"
        server: "*"
    clusterResourceWhitelist:
      - group: "*"
        kind: "*"
