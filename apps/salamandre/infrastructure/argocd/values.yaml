plugin: argocd-vault-plugin-helm

ingress:
  subdomain: argocd

source:
  repoURL: https://argoproj.github.io/argo-helm
  chart: argo-cd
  targetRevision: 5.16.7

destination:
  namespace: argocd

syncPolicy:
  automated:
    prune: true
    selfHeal: true

# App values
argocdVersion: 2.5.5
gitlabProjectID: '40446088'
vaultURL: http://vault-internal.vault.svc:8200

toolsVersion:
  avp: "1.13.1"
  vault: "1.12.2"

baseOidcConfig:
  name: Keycloak
  issuer: <path:salamandre/data/argocd/oidc#issuer>
  cliClientID: <path:salamandre/data/argocd/oidc#cliClientID>
  clientID: <path:salamandre/data/argocd/oidc#clientID>
  clientSecret: $$oidc.keycloak.clientSecret
  logoutURL: '{{ print "<path:salamandre/data/argocd/oidc#issuer>/protocol/openid-connect/logout?client_id=<path:salamandre/data/argocd/oidc#clientID>&post_logout_redirect_uri={{logoutRedirectURL}}" }}'
  requestedIDTokenClaims:
    groups:
      essential: true
  requestedScopes:
    - openid
    - profile
    - email
    - groups

projects:
  - name: system
    description: System cluster critical apps
    sourceRepos:
      - "*"
    destinations:
      - namespace: "*"
        server: "*"
    clusterResourceWhitelist:
      - group: "*"
        kind: "*"
  - name: infrastructure
    description: Infrastructure apps
    sourceRepos:
      - "*"
    destinations:
      - namespace: "*"
        server: "*"
    clusterResourceWhitelist:
      - group: "*"
        kind: "*"
  - name: cloud
    description: Cloud apps
    sourceRepos:
      - "*"
    destinations:
      - namespace: "*"
        server: "*"
    clusterResourceWhitelist:
      - group: "*"
        kind: "*"
