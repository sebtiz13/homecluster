priorityClassName: system-cluster-critical

ingressClass:
  enabled: true
  isDefaultClass: true

providers:
  kubernetesIngress:
    publishedService:
      enabled: true

env:
  - name: TZ
    value: Europe/Paris

metrics:
  prometheus:
    service:
      enabled: true
    serviceMonitor:
      enabled: true
      jobLabel: traefik
      honorLabels: true

{{- $domainName := .Values.baseDomain | replace "." "-" }}
extraObjects:
  - apiVersion: traefik.io/v1alpha1
    kind: Middleware
    metadata:
      name: redirect-https
    spec:
      redirectScheme:
        scheme: https
        permanent: true
  - apiVersion: traefik.io/v1alpha1
    kind: TLSStore
    metadata:
      name: default
    spec:
      defaultCertificate:
        secretName: {{ $domainName }}-tls
  - apiVersion: cert-manager.io/v1
    kind: Certificate
    metadata:
      name: {{ $domainName }}
    spec:
      secretName: {{ $domainName }}-tls
      secretTemplate:
        annotations:
          kubed.appscode.com/sync-contexts: baku
      issuerRef:
        name: {{ $domainName }}-issuer
        kind: ClusterIssuer
      dnsNames:
        - "{{ .Values.baseDomain }}"
        - "*.{{ .Values.baseDomain }}"
        - "console.s3.{{ .Values.baseDomain }}"
