ovhIssuers:
  - name: {{ .Values.baseDomain | replace "." "-" }}-issuer
    kind: ClusterIssuer
    create: true
    namespace: {{ .Values.destination.namespace }}
    server: https://acme-v02.api.letsencrypt.org/directory
    email: "contact@{{ .Values.baseDomain }}"
    preferredChain: ISRG Root X1
    ovhEndpointName: ovh-eu
    ovhAuthenticationRef:
      applicationKey:
        name: ovh-credentials
        key: applicationKey
      applicationSecret:
        name: ovh-credentials
        key: applicationSecret
      consumerKey:
        name: ovh-credentials
        key: consumerKey

extraObjects:
  - apiVersion: external-secrets.io/v1beta1
    kind: ExternalSecret
    metadata:
      name: ovh-credentials
    spec:
      secretStoreRef:
        name: vault-eso
        kind: ClusterSecretStore
      refreshInterval: 1h
      dataFrom:
        - extract:
            key: salamandre/cert-manager/ovh
