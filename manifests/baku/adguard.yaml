---
# Source: common-app/templates/application.yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: baku-adguard
  labels:
    helm.sh/chart: common-app-0.0.1
    app.kubernetes.io/version: "0.0.1"
    app.kubernetes.io/managed-by: Helm
  annotations:
    sebtiz13.fr/host: adguard.sebtiz13.fr
spec:
  project: infrastructure
  source:
    repoURL: https://gitlab.com/api/v4/projects/40446088/packages/helm/stable
    chart: adguard
    targetRevision: 1.0.1
    plugin:
      env:
        - name: HELM_RELEASE_NAME
          value: adguard
        - name: HELM_VALUES
          value: |
            bootstrapConfig:
              bind_port: 8080
              dhcp:
                dhcpv4:
                  gateway_ip: 10.0.0.1
                  range_end: 10.0.1.254
                  range_start: 10.0.1.1
                  subnet_mask: 255.255.0.0
                enabled: true
                interface_name: enp2s0
              dns:
                bootstrap_dns:
                - 9.9.9.10
                - 149.112.112.10
                - 2620:fe::10
                - 2620:fe::fe:10
                - 1.1.1.1
                - 1.0.0.1
                querylog_interval: 24h
                rewrites:
                - answer: 10.0.0.2
                  domain: baku.home
                - answer: baku.home
                  domain: '*.baku.home'
                - answer: baku.home
                  domain: baku.sebtiz13.fr
                upstream_dns:
                - https://dns10.quad9.net/dns-query
                - https://dns.cloudflare.com/dns-query
              filters:
              - enabled: true
                id: 1
                name: AdGuard DNS filter
                url: https://adguardteam.github.io/AdGuardSDNSFilter/Filters/filter.txt
              - enabled: true
                id: 2
                name: '[ads] AdAway Default Blocklist'
                url: https://adaway.org/hosts.txt
              - enabled: true
                id: 3
                name: '[susp] KADhosts'
                url: https://raw.githubusercontent.com/PolishFiltersTeam/KADhosts/master/KADhosts.txt
              - enabled: true
                id: 4
                name: '[susp] FadeMind - add.Spam'
                url: https://raw.githubusercontent.com/FadeMind/hosts.extras/master/add.Spam/hosts
              - enabled: true
                id: 5
                name: '[susp] Personal Blocklist by WaLLy3K'
                url: https://v.firebog.net/hosts/static/w3kbl.txt
              - enabled: true
                id: 6
                name: '[ads] Firebog - Adguard DNS'
                url: https://v.firebog.net/hosts/AdguardDNS.txt
              - enabled: true
                id: 7
                name: '[ads] Firebog - Admiral'
                url: https://v.firebog.net/hosts/Admiral.txt
              - enabled: true
                id: 8
                name: '[ads] Anudeep''s Blacklist'
                url: https://raw.githubusercontent.com/anudeepND/blacklist/master/adservers.txt
              - enabled: true
                id: 9
                name: '[ads] Disconnect - DNS filter'
                url: https://s3.amazonaws.com/lists.disconnect.me/simple_ad.txt
              - enabled: true
                id: 10
                name: '[ads] Firebog - Easylist'
                url: https://v.firebog.net/hosts/Easylist.txt
              - enabled: true
                id: 11
                name: '[ads] Peter Lowe - DNS filter'
                url: https://pgl.yoyo.org/adservers/serverlist.php?hostformat=hosts&showintro=0&mimetype=plaintext
              - enabled: true
                id: 12
                name: '[ads] FadeMind - UncheckyAds'
                url: https://raw.githubusercontent.com/FadeMind/hosts.extras/master/UncheckyAds/hosts
              - enabled: true
                id: 13
                name: '[ads] hostsVN'
                url: https://raw.githubusercontent.com/bigdargon/hostsVN/master/hosts
              - enabled: true
                id: 14
                name: '[track&tel] Firebog - Easyprivacy'
                url: https://v.firebog.net/hosts/Easyprivacy.txt
              - enabled: true
                id: 15
                name: '[track&tel] FadeMind - add.2o7Net'
                url: https://raw.githubusercontent.com/FadeMind/hosts.extras/master/add.2o7Net/hosts
              - enabled: true
                id: 16
                name: '[track&tel] WindowsSpyBlocker'
                url: https://raw.githubusercontent.com/crazy-max/WindowsSpyBlocker/master/data/hosts/spy.txt
              - enabled: true
                id: 17
                name: '[track&tel] First-party trackers'
                url: https://hostfiles.frogeye.fr/firstparty-trackers-hosts.txt
              - enabled: true
                id: 18
                name: '[mal] Firebog - Prigent Crypto'
                url: https://v.firebog.net/hosts/Prigent-Crypto.txt
              - enabled: true
                id: 19
                name: '[mal] ethanr - Mandiant APT1 Report Appendix D'
                url: https://bitbucket.org/ethanr/dns-blacklists/raw/8575c9f96e5b4a1308f2f12394abd86d0927a4a0/bad_lists/Mandiant_APT1_Report_Appendix_D.txt
              - enabled: true
                id: 20
                name: '[mal] Phishing Army - The Blocklist to filter Phishing'
                url: https://phishing.army/download/phishing_army_blocklist_extended.txt
              - enabled: true
                id: 21
                name: '[mal] NoTrack Malware Blocklist'
                url: https://gitlab.com/quidsup/notrack-blocklists/raw/master/notrack-malware.txt
              - enabled: true
                id: 22
                name: '[mal] Spam404'
                url: https://raw.githubusercontent.com/Spam404/lists/master/main-blacklist.txt
              - enabled: true
                id: 23
                name: '[mal] FadeMind - add.Risk'
                url: https://raw.githubusercontent.com/FadeMind/hosts.extras/master/add.Risk/hosts
              - enabled: true
                id: 24
                name: '[mal] abuse.ch URLhaus Host file'
                url: https://urlhaus.abuse.ch/downloads/hostfile/
              - enabled: true
                id: 25
                name: "[mal] \U0001F48A Dandelion Sprout's Anti-Malware List"
                url: https://raw.githubusercontent.com/DandelionSprout/adfilt/master/Alternate%20versions%20Anti-Malware%20List/AntiMalwareHosts.txt
              - enabled: true
                id: 26
                name: '[mal] Threat-Intel'
                url: https://osint.digitalside.it/Threat-Intel/lists/latestdomains.txt
              - enabled: true
                id: 27
                name: '[mal] Disconnect - Malvertising list'
                url: https://s3.amazonaws.com/lists.disconnect.me/simple_malvertising.txt
              - enabled: true
                id: 28
                name: '[other] CoinBlockerLists'
                url: https://zerodot1.gitlab.io/CoinBlockerLists/hosts_browser
              - enabled: true
                id: 29
                name: '[porno] list'
                url: https://raw.githubusercontent.com/mhhakim/pihole-blocklist/master/porn.txt
              tls:
                port_https: 4443
                server_name: baku.home
              user_rules:
              - '# Spotify'
              - '@@||wl.spotify.com^$important'
              - '# Brave sync'
              - '@@||sdk.fra-01.braze.eu^$important'
              - '# Twitter'
              - '@@||t.co^$important'
              - '# Other'
              - '@@||go.ndi.tv^$important'
              users:
              - name: <path:baku/data/adguard/auth#adminUser>
                passowrd: <path:baku/data/adguard/auth#adminPassword>
            hostNetwork:
              enabled: true
            ingresses:
              http:
                annotations:
                  traefik.ingress.kubernetes.io/router.entrypoints: web
                className: traefik
                enabled: true
                hosts:
                - host: adguard.baku.home
                  paths:
                  - path: /
                    pathType: ImplementationSpecific
            persistence:
              enabled: true
              size: 1Gi
            services:
              dns:
                enabled: false
              dnsOverQuic:
                enabled: false
              dnsOverTls:
                enabled: false
              dnscrypt:
                enabled: false
              https:
                enabled: false
  destination:
    name: baku
    namespace: adguard
  syncPolicy:
    automated: 
      prune: true
      selfHeal: true
