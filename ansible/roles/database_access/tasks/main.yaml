- name: DB access | Create user
  delegate_to: "{{ inventory_hostname }}"
  become: true
  become_user: postgres
  vars:
    ansible_ssh_pipelining: true
  community.postgresql.postgresql_user:
    name: "{{ username }}"
    password: "{{ password }}"

- name: DB access | Create database
  delegate_to: "{{ inventory_hostname }}"
  become: true
  become_user: postgres
  vars:
    ansible_ssh_pipelining: true
  community.postgresql.postgresql_db:
    name: "{{ database }}"
    owner: "{{ username }}"
