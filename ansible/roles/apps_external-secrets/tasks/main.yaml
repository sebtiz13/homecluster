- name: Deploy application manifest
  kubernetes.core.k8s:
    kubeconfig: "{{ local_kubeconfig }}"
    state: present
    src: "{{ manifests_folder }}/external-secrets.yaml"
    namespace: "{{ apps_argocd.namespace }}"

- name: Wait until application is available
  kubernetes.core.k8s_info:
    kubeconfig: "{{ local_kubeconfig }}"
    kind: Deployment
    name: "{{ apps_external_secrets.release_name }}-webhook"
    namespace: "{{ apps_external_secrets.namespace }}"
    wait: true
    wait_sleep: 10
    wait_timeout: 360
