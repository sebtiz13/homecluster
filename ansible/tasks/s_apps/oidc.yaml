# ? Vault is managed in "vault_oidc" role

- name: Zitadel | Create Forgejo oidc access # noqa: var-naming[no-role-prefix]
  tags: forgejo
  ansible.builtin.include_role:
    name: oidc_access
  vars:
    secret_path: salamandre/data/forgejo/oidc
    project_id: "{{ zitadel_dev_project_id }}"
    app_name: Forgejo
    redirect_uris:
      - "{{ external_urls.forgejo }}/user/oauth2/zitadel/callback"
    post_logout_redirect_uris:
      - "{{ external_urls.forgejo }}/user/login"
    response_types:
      - OIDC_RESPONSE_TYPE_CODE
    grant_types:
      - OIDC_GRANT_TYPE_AUTHORIZATION_CODE
      - OIDC_GRANT_TYPE_REFRESH_TOKEN
    auth_method_type: OIDC_AUTH_METHOD_TYPE_BASIC

- name: Zitadel | Create Grafana oidc access # noqa: var-naming[no-role-prefix]
  tags: grafana
  ansible.builtin.include_role:
    name: oidc_access
  vars:
    secret_path: baku/data/grafana/oidc
    project_id: "{{ zitadel_dev_project_id }}"
    app_name: Grafana
    redirect_uris:
      - "{{ external_urls.grafana }}/login/generic_oauth"
    post_logout_redirect_uris:
      - "{{ external_urls.grafana }}/login"
    response_types:
      - OIDC_RESPONSE_TYPE_CODE
    grant_types:
      - OIDC_GRANT_TYPE_AUTHORIZATION_CODE
      - OIDC_GRANT_TYPE_REFRESH_TOKEN
    auth_method_type: OIDC_AUTH_METHOD_TYPE_BASIC
